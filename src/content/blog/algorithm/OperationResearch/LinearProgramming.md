---
title: "线性规划"
description: "线性规划基础理论和单纯形法"
publishDate: "2026-01-04"
updateDate: "2026-01-04"
tags: ["运筹学", "线性规划", "优化"]
---

# 算法是解决问题的方法，运筹学也是解决问题的方法！
好了，主要上了一个运筹学的专业课，感觉是这专业难得学到的有用的知识。
遂纳入博客！

# 明确运筹学问题的三大核心关注点

当我们想要用运筹学方法来解决一个问题的时候，我们一定要回答三个问题：

* 我们要优化的目标是什么？（目标函数）
* 我们有哪些可以控制的决策变量？（决策变量）
* 我们面临哪些限制条件？（约束条件）

在接下来的问题中，无论是解决什么问题，都永远离不开这三个问题的关注。

在这一章中，我们会首先介绍什么是线性规划，接着介绍解决线性规划问题的两种方法（图解法、单纯形法），并介绍从单纯形法上，衍生出来的大M法和两阶段法。

# 线性规划
什么是线性规划？

线性规划，顾名思义就是线性的规划，无论是目标函数还是约束条件，都是线性的。

这里我们就需要介绍线性规划标准形概念：

$$
\max \quad Z = c_1x_1 + c_2x_2 + \cdots + c_nx_n
$$

$$
\text{s.t.}
\begin{cases}
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1 \\\
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2 \\\
\vdots \\\
a_{m1}x_1 + a_{m2}x_2 + \cdots + a_{mn}x_n = b_m \\\
x_i \ge 0,\quad i=1,\dots,n
\end{cases}
$$

这就是线性规划的标准形。

为什么要引入线性规划标准形？

这是因为线性规划是一个非常开放的问题，有很多种形式，但是我们想要得到统一性的解法。

在这样的情况下，必须有一个标准才行，约束条件是大于还是小于都会影响我们提出最优解法，同时，变量是否允许为负数也会影响解法的提出。

因此我们提出一套标准化的方案，来进行线性规划的标准化：

!!!warning "线性规划的标准形必须满足四大特征"
    * 目标函数是一个最大化问题
    * 约束条件中所有条件均为等式
    * 所有决策变量均为正值
    * 右端项均为非负值

围绕上述的方法，我们可以提出四大转换步骤：
!!!info "线性规划如何进行标准化？"
    * 利用$$Z' = -Z$$将最小化问题转化为最大化问题
    * 利用引入松弛变量或剩余变量将不等式约束转化为等式约束
    * 利用$$x_i' = -x_i$$将允许为负的变量转化为非负变量。如果在原变量无约束的情况下，我们就令$$x_i = x_i^+ - x_i^-$$，其中$$x_i^+, x_i^- \ge 0$$
    * 利用$$-1 \times (\text{约束条件})$$将右端项为负的约束条件转化为右端项为非负的约束条件

通过上述四个步骤，我们就可以将一个线性规划问题转化为标准形。

得到了标准型的线性规划之后，我们就要开始解决问题了。

# 线性规划的图解法
线性规划的图解法，顾名思义就是通过图形来解决线性规划问题。

这里就体现我们标准化的必要性了：只有标准化后，才能严谨地绘制出图形。

图解法的详细步骤并没有什么介绍意义，我们的重心也不在这里，但是我们还是要给出一个方法：

!!!info "线性规划图解法的步骤"
    1. 绘制约束条件的图形
    2. 确定可行域
    3. 确定目标函数的等值线
    4. 将目标函数的等值线平行移动，直到与可行域的边界相切

!!!note "为什么图解法中，每一个约束条件的线的交点一定是基可行解？"
    这是因为在二维空间中，每一个约束条件都可以表示为一条直线，而基可行解是由约束条件的交点所确定的。

    在二维空间中，两个约束条件的交点就是这两个约束条件所形成的线段的端点，而这些端点正是基可行解所在的位置。

    因此，在图解法中，每一个约束条件的线的交点一定是基可行解。

    后续会给出证明。

# 线性规划的单纯形法
好了，接下来我们正式进入单纯形法的解题步骤。

!!!info "单纯形的意思"
    单纯形这个词其实来自英语中的“simplex”，其作为形容词，词义为“通过单一部分刻画的，”来自拉丁语“simplex”,词义为“single(单一的)，simple(简单的)，plain(朴实的)，unmixed(纯粹的)，uncompounded(非复合的)，” 字面意思是“one-fold (单一的；单纯的)”。

    在几何学中，一个单纯形(复数：simplexes或simplices)是一个三角形(triangle)或四面体(tetrahedron)的概念向任意维度的推广。命名为单纯形是因为它表示任意已知维度中最简单的多面体(polytope)。例如：一个0维单纯形(0-dimensional)是一个点，一个1维单纯形(1-dimensional)是一条线段，一个2维单纯形(2-dimensional)是一个三角形，一个3维单纯形(3- dimensional)是一个多面体，一个4单纯形(4- dimensional)是一个5点细胞体(5-cell)，

    在代数层面，单纯形法每次迭代都会维护一个“基”（Basis），这里的基其实就是单纯形的一个顶点，而每次迭代的过程就是在单纯形的顶点之间移动，直到找到最优解。
    在线性规划的标准型中，每一组“基变量”在几何空间中对应的一组列向量，可以看作是构成了一个单纯形锥。更具体地说，当丹齐格最初构思这个算法时，他观察到：如果你观察约束矩阵的列向量，并对其进行归一化处理（例如在投影空间中看），这些列向量构成的正是几何上的单纯形。从一个基更换到另一个基（转轴操作/Pivoting），在几何上就相当于从单纯形的一个顶点移动到另一个顶点。

单纯形法的详细步骤如下：

首先我们已经知道了，单纯形法的目的是为了从一个基可行解出发，逐步移动到另一个基可行解，直到找到最优可行解。

那么如何找到第一个基可行解？

毫无疑问，单位矩阵是一个非常漂亮的基可行解.

!!!note "基解，基可行解，基，最优基可行解"
    * **基解**：基解的意思是满足约束条件的解，不考虑非负性约束。
    * **基可行解**：基可行解是在基解的基础上，满足非负性约束的解。
    * **基**：基是指在单纯形法中，选择的一组变量，这些变量被称为基变量，其余变量被称为非基变量。基变量对应的列向量构成了一个线性无关的集合。
    * **最优基可行解**：最优基可行解是指在所有基可行解中，使目标函数达到最大值（或最小值）的那个解。
    通过上述定义，我们可以清晰地区分这些概念，并且在运筹学中，我们会反复强调这些概念。

这也就是为什么我们需要转化标准形了.

当我们转化了一个这样的线性规划问题：

$$
\max \quad Z = c_1x_1 + c_2x_2
$$

$$
\text{s.t.}
\begin{cases}
a_{11}x_1 + a_{12}x_2 \le b_1 \\\
a_{21}x_1 + a_{22}x_2 \le b_2 \\\
x_1, x_2 \ge 0
\end{cases}
$$

为标准形：

$$
\max \quad Z = c_1x_1 + c_2x_2
$$

$$
\text{s.t.}
\begin{cases}
a_{11}x_1 + a_{12}x_2 + x_3 = b_1 \\\
a_{21}x_1 + a_{22}x_2 + x_4 = b_2 \\\
x_1, x_2, x_3, x_4 \ge 0
\end{cases}
$$

我们就可以很容易地发现：

$$
\begin{cases}
x_1 = 0 \\\
x_2 = 0 \\\
x_3 = b_1 \\\
x_4 = b_2
\end{cases}
$$

是一个基可行解。

于是我们就可以开始列出单纯形表：

| 基变量 | $$x_1$$ | $$x_2$$ | $$x_3$$ | $$x_4$$ | 右端项 |
| ------ | ----- | ----- | ----- | ----- | ------ |
| $$x_3$$  | $$a_{11}$$ | $$a_{12}$$ | 1     | 0     | $$b_1$$  |
| $$x_4$$  | $$a_{21}$$ | $$a_{22}$$ | 0     | 1     | $$b_2$$  |
| $$Z$$    | $$c_1-0*a_{11}-0*a_{21}$$ | $$c_2 - 0*a_{12}-0*a_{22}$$ | 0     | 0     | 0      |
!!!tip "Z的计算"
    $$z=c_j-基变量系数乘以对应列的值$$

接下来我们就要开始进行单纯形迭代了。

首先我们要确定进入基的变量。
这是因为我们要最大化目标函数，因此我们要选择一个能够增加目标函数值的变量。

在单纯形表中，我们可以通过查看$$Z$$行中的系数来确定进入基的变量，我们要找到这个行中最大的数.

!!! info "为什么选择最大的数？"
    这是因为在单纯形法中，目标函数的系数表示了每个变量对目标函数的贡献程度。选择系数最大的变量作为进入基的变量，可以最大化目标函数的增量，从而更快地接近最优解。

假设$$c_1 - 0*a_{11}-0*a_{21} > c_2 - 0*a_{12}-0*a_{22}$$，那么我们选择$$x_1$$进入基。

接下来我们要确定离开基的变量。
这是因为我们要保持基变量的数量不变，因此我们需要选择一个变量离开基。

在单纯形表中，我们可以通过计算每个基变量对应的右端项与进入基变量对应的系数的比值来确定离开基的变量，我们要选择比值最小的那个变量。
假设$$\frac{b_1}{a_{11}} < \frac{b_2}{a_{21}}$$，那么我们选择$$x_3$$离开基。
!!! info "为什么选择比值最小的变量？"
    这是因为在单纯形法中，选择比值最小的变量作为离开基的变量，可以确保新的基变量能够满足非负性约束，从而保持解的可行性。
    为什么呢？这是因为比值最小的变量对应的约束条件最紧张，选择它作为离开基的变量，可以最大限度地利用进入基变量的增加，从而更快地接近最优解。

现在我们已经确定了进入基的变量和离开基的变量，我们就可以进行枢轴操作了。

枢轴操作的步骤如下：

1. 将离开基变量所在行除以进入基变量对应的系数，使得进入基变量的系数变为1。

2. 对其他行进行行变换，使得进入基变量在其他行中的系数变为0。

通过上述步骤，我们就可以得到一个新的单纯形表。

我们重复上述的步骤，直到$$Z$$行中的系数全部为非正数为止。

当$$Z$$行中的系数全部为非正数时，我们就找到了最优基可行解。

# 大M法与两阶段法

在实际应用中，我们可能会遇到一些线性规划问题，其初始基可行解并不容易找到，比如说最原始的约束条件中，包含有大于号，这时我们要减去剩余变量来转化为等式约束，但是减去剩余变量会导致我们缺失单位矩阵，无法得到基可行解。

!!!warning "为什么一定要单位矩阵？"
    这是因为在单纯形法中，基变量对应的列向量必须是线性无关的，而单位矩阵的列向量正好满足这个条件。

    如果我们没有单位矩阵，那么我们就无法保证基变量的线性无关性，从而无法进行单纯形迭代。

    因此，为了保证单纯形法的正确性，我们必须确保基变量对应的列向量构成一个单位矩阵。

为了解决这个问题，我们引入了大M法和两阶段法。

!!!info "大M法"
    大M法是一种通过引入一个非常大的惩罚系数M，来强制约束条件满足的线性规划求解方法。其基本思想是在目标函数中加入一个惩罚项，当约束条件不满足时，惩罚项会使目标函数的值变得非常大，从而迫使解满足约束条件。

    具体步骤如下：

    *  对于每一个“≥”类型的约束条件，引入一个人工变量，并在目标函数中加入一个惩罚项M乘以该人工变量。
    
    * 将所有约束条件转化为等式形式。
    
    * 使用单纯形法进行求解。
    
    * 在求解过程中，如果人工变量的值不为零，则说明原问题无可行解。

    其实大M法也就相当于，既然没有，那我就在约束条件里加一个构造单位矩阵，但是不能影响目标函数，于是我就在目标函数里加一个绝对值巨大的M，让它尽可能不出现在最终解中。
!!!info "两阶段法"
    两阶段法是一种通过分两步求解线性规划问题的方法。其基本思想是先通过引入人工变量，找到一个初始基可行解，然后再通过单纯形法求解原问题.
    
    两阶段法就正好和大M法相反了，操作还是一样，先在约束条件里引入人工变量构造单位矩阵，但是不在目标函数里加M，而是分两步走。

    具体步骤如下：

    * 在第一阶段中，对于每一个“≥”类型的约束条件，引入一个人工变量，并构建一个新的目标函数，最小化所有人工变量的和。
    
    * 使用单纯形法求解第一阶段的问题，得到一个基可行解。
    
    * 在第二阶段中，使用第一阶段得到的基可行解作为初始基可行解，使用单纯形法求解原问题。
    

容易发现思路还是很类似的。
通过上述两种方法，我们就可以解决那些初始基可行解难以找到的线性规划问题。
# 结语
好了，以上就是线性规划的基本内容。

后续我们还会介绍比如对偶单纯形法，灵敏度分析等内容，但这些显然不用再这里提到，而且哪些其实都是花活，会上面的，基本上你用计算机就能求。

* 概念性问题：区分四种解

* 概念性问题：为什么一定要是单位矩阵？

* 概念性问题：为什么选择最大的数？为什么选择比值最小的变量？

* 概念性问题：为什么图解法中，每一个约束条件的线的交点一定是基可行解？如何证明？